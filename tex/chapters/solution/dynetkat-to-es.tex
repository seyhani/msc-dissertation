\section{مدل معنایی عبارات نت‌کت پویا در قالب ساختمان رویداد}
در این بخش ابتدا انواع ترکیب و محدود‌سازی ساختمان‌‌های رویداد تعریف می‌شود.
سپس با استفاده از این تعاریف  یک مدل معنایی برای عبارات نت‌کت پویا ارائه می‌شود.

\begin{definition}
    فرض کنید
    $\mr{E} = (E,\#,\vdash)$
    یک ساختمان رویداد باشد.
    به ازای یک مجموعه‌ی
    $A \subseteq E$
    ،
    محدودیت
    \lf{Restriction}
    $\mr{E}$
    به
    $A$
    یک ساختمان رویداد به شکل زیر است:
    \begin{align*}
        \mr{E} \lceil A = (A,\#_A,\vdash_A)
    \end{align*}
    که اگر 
    $Con_A$
    مجموعه‌ی تمامی زیرمجموعه‌های بدون تعارض 
    $A$ 
    در 
    $\mr{E}\lceil A$
    باشد آنگاه داشته باشیم:
    \begin{align*}
        X \subseteq Con_A & \iff X \subseteq A \wedge X \in Con                 \\
        X \vdash_A e      & \iff X \subseteq A \wedge e \in A \wedge X \vdash e
    \end{align*}
\end{definition}

\begin{definition}
    فرض کنید
    $\mr{E} = (E,\#,\vdash)$
    یک ساختمان رویداد و
    $a$
    یک رویداد باشد.
    ساختمان رویداد
    $a\mr{E} = (E',\#',\vdash')$
    که به معنای افزودن رویداد 
    $a$
    به عنوان پیشوند
    به 
    $\mr{E}$
    است
    به گونه‌ای تعریف می‌شود که داشته باشیم:
    \begin{align*}
         & E' = \s{(0,a)} \cup \s{(1,e)|e \in E},                                                                               \\
         & e_0' \#' e_1'  \iff \exists e_0,e_1.e_0' = (1,e_0)
        \ \wedge \ e_1' = (1,e_1) \ \wedge \ e_0 \# e_1                                                                         \\
         & X \vdash' e' \iff e' = (0,a) \text{ or } [e' = (1,e_1) \ \wedge \ (0,a)\in X \ \wedge \ \s{e|(1,e)\in X} \vdash e_1]
    \end{align*}
\end{definition}

\begin{definition}
    یک ساختمان رویداد برچسب‌دار
    \lf{Labeled Event Structure}
    یک پنج‌تایی به شکل
    $(E,\#,\vdash,L,l)$
    است که در آن
    $(E,\#,\vdash)$
    یک ساختمان رویداد،
    $L$
    یک مجموعه از برچسب‌ها
    (فاقد عنصر *
    \footnote{
        در ادامه از * برای مشخص کردن رویداد‌های ناهمگام استفاده می‌کنیم. به همین دلیل این عنصر را به عنوان یک برچسب خاص از مجموعه‌ی برچسب‌های ممکن کنار می‌گذاریم.
    }
    )
    و
    $l$
    یک تابع به فرم
    $l: E \ra L$
    است که به هر رویداد یک برچسب اختصاص می‌دهد.
    یک ساختمان رویداد برچسب‌دار را به اختصار به صورت
    $(\mr{E},L,l)$
    نشان می‌دهیم.
\end{definition}

\begin{definition}
    در یک ساختمان رویداد رابطه‌ی
    $\doublevee$
    را به صورت زیر تعریف می‌کنیم:
    \begin{align*}
        e \doublevee e' \iff e \# e' \vee e = e'
    \end{align*}
\end{definition}

\begin{definition}
    فرض کنید
    $(\mr{E},L,l)$
    یک ساختمان رویداد برچسب‌دار و
    $\alpha$
    یک برچسب باشد.
    $\alpha(\mr{E},L,l)$
    را به صورت یک ساختمان رویداد برچسب‌دار به شکل
    $(\alpha \mr{E},L',l)$
    تعریف می‌کنیم که در آن
    $L' = \s{\alpha}\cup L$
    و به ازای هر
    $e' \in E'$
    داشته باشیم:
    $$
        l'(e') = \begin{cases}
            \alpha & \text{ if } e = (0,\alpha) \\
            l(e)   & \text{ if } e = (1,e)
        \end{cases}
    $$
\end{definition}

\begin{definition}
    فرض کنید
    $\mr{E}_0 = (E_0,\#_0,\vdash_0,L_0,l_0)$
    و
    $\mr{E}_1 = (E_1,\#_1,\vdash_1,L_1,l_1)$
    دو ساختمان رویداد برچسب‌دار باشند.
    مجموع این دو ساختمان رویداد
    $\mr{E}_0 + \mr{E}_1$
    را به صورت یک ساختمان رویداد برچسب‌دار
    $(E,\#,\vdash,L,l)$
    تعریف می‌کنیم که در آن داشته باشیم:
    \begin{align*}
        E = \s{(0,e)|e \in E_0} \cup \s{(1,e)|e \in E_1}
    \end{align*}
    با استفاده از این مجموعه از رویداد‌ها توابع
    $\iota_k: E_k \ra E$
    را به ازای
    $k=0,1$
    به شکل زیر تعریف می‌کنیم:
    \begin{align*}
        \iota_k(e) = (k,e)
    \end{align*}
    رابطه‌ی تعارض را به گونه‌ای تعریف می‌کنیم که داشته باشیم:
    \begin{align*}
        e \# e' \iff & \exists e_0,e_0'. e = \iota_0(e_0)
        \wedge e' = \iota_0(e_0') \wedge e_0 \#_0e_0'             \\
                     & \bigvee \exists e_1,e_1'. e = \iota_1(e_1)
        \wedge e' = \iota_1(e_1') \wedge e_1 \#_1 e_1'            \\
                     & \bigvee \exists e_0,e_1.(e=\iota_1(e_0)
        \wedge e' =\iota_1(e_1)) \vee
        (e'=\iota_1(e_0) \wedge e =\iota_1(e_1))
    \end{align*}
    رابطه‌ی فعال‌سازی را به گونه‌ای تعریف می‌کنیم که داشته باشیم:
    \begin{align*}
        X \vdash e \iff & X \in Con \wedge e \in E \wedge                   & \\
                        & (\exists X_0 \in Con_0,e_0 \in E_0.X = \iota_0X_0
        \wedge e = \iota_0(e_0) \wedge X_0 \vdash_0 e_0) \text{ or }          \\
                        & (\exists X_1 \in Con_1,e_1 \in E_1.X = \iota_1X_1
        \wedge e = \iota_1(e_1) \wedge X_1 \vdash_1 e_1)                      \\
    \end{align*}
     مجموعه‌ی برچسب‌ها را به صورت
    $L = L_0 \cup L_1$
    و تابع برچسب‌گذاری را به شکل تعریف می‌کنیم:
    $$
        l(e) = \begin{cases}
            l_0(e_0) & \text{ if } e = \iota_0(e_0) \\
            l_1(e_1) & \text{ if } e = \iota_1(e_1)
        \end{cases}
    $$
\end{definition}

\begin{definition}
    فرض کنید که
    $\mr{E_0} = (E_0,\#_0,\vdash_0,L_0,l_0)$
    و
    $\mr{E_1} = (E_1,\#_1,\vdash_1,L_1,l_1)$
    دو ساختار رویداد برچسب‌گذاری شده باشند.
    حاصلضرب آن‌ها
    $\mr{E}_0 \times \mr{E}_1$
    را به صورت یک ساختمان رویداد برچسب‌گذاری شده
    $\mr{E} = (E,\#,\vdash,L,l)$
    تعریف می‌کنیم که در‌ آن رویداد‌ها به صورت زیر تعریف می‌شوند:
    \begin{align*}
        E_0 \times_* E_1 =
        \s{(e_0,*)|e_0 \in E_0}
        \cup \s{(*,e_1)|e_1 \in E_1}
        \cup \s{(e_0,e_1)| e_0 \in E_0 \wedge e_1 \in E_1}
    \end{align*}
    با توجه به این مجموعه‌ رویداد‌ها توابعی به شکل
    $\pi_i: E \ra_* E_i$
    تعریف می کنیم که به ازای
    $i=0,1$
    داشته باشیم:
    $\pi_i(e_0,e_1) = e_i$.
    در اینجا رابطه‌ی تعارض را به کمک رابطه‌ی
    $\doublevee$
    که پیش‌تر تعریف شد، به شکل زیر به ازای تمامی رویداد‌های
    $e,e' \in E$
    توصیف می‌کنیم:
    \begin{align*}
        e \doublevee e' \iff
        \pi_0(e)\doublevee_0 \pi_0(e')
        \vee \pi_1(e)\doublevee_1\pi_1(e')
    \end{align*}
    رابطه‌ی فعال‌سازی  را به صورت زیر تعریف می‌کنیم:
    \begin{align*}
         & X \vdash e \iff X \in Con \wedge e \in \mathcal{E} \wedge     \\
         & (\pi_0(e)\text{ defined } \Rightarrow \pi_0X\vdash_0\pi_0(e))
        \wedge (\pi_1(e)\text{ defined } \Rightarrow \pi_1X\vdash_1\pi_1(e))
    \end{align*}
    مجموعه‌ی برچسب‌های حاصلضرب را به صورت زیر تعریف می‌کنیم:
    \begin{align*}
        L_0 \times_* L_1 = \s{ (\alpha_0,*)|\alpha_0 \in L_0}
        \cup \s{(*,\alpha_1)|\alpha_1 \in L_1}
        \cup \s{(\alpha_0,\alpha_1)|\alpha_0 \in L_0 \wedge \alpha_1 \in L_1}
    \end{align*}
    در انتها تابع برچسب‌گذاری را به صورت زیر تعریف می‌کنیم:
    \begin{align*}
        l(e) = (l_0(\pi_0(e),l_1(\pi_1(e))))
    \end{align*}
\end{definition}

\begin{definition}
    فرض کنید که
    $\mr{E} = (E,\#,\vdash,L,l)$
    یک ساختمان رویداد برچسب‌دار باشد.
    فرض کنید
    $\Lambda$
    یک زیرمجموعه از
    $L$
    باشد.
    محدودیت
    $\mr{E}$
    به
    $\Lambda$
    را به صورت
    $\mr{E}\lceil\Lambda$
    و به شکل یک ساختمان رویداد برچسب‌گذاری شده به شکل
    $(E',\#',\vdash',L\cap\Lambda,l')$
    که در آن
    $(E',\#',\vdash') = (E,\#,\vdash)\lceil \s{e \in E|l(e)\in \Lambda}$
    است و تابع برچسب‌گذاری معادل محدودسازی تابع
    $l$
    به دامنه‌ی
    $L\cap \Lambda$
    است.
\end{definition}

\subsection{معنای عبارات نت‌کت پویای نرمال}
در ادامه ابتدا فرم نرمال عبارات نت‌کت پویا را تعریف می‌کنیم.
فرض کنید که فیلد‌های ممکن برای بسته‌ها 
$f_1,f_2,...,f_k$
باشند.
یک فیلتر کامل
\lf{Complete Test}
به صورت
$\alpha = f_1 = n_1 ... f_k = n_k$
و یک اختصاص کامل
\lf{Complete Assignment}
به صورت
$\pi = f_1 \la n_1 ... f_k \la n_k$
تعریف می‌شود.
می‌گوییم یک عبارت
$q$
در
$NetKAT^{-dup}$
به فرم نرمال است
اگر به شکل
$\Sigma_{\alpha\cdot\pi \in \mathcal{A}}\alpha\cdot\pi$
باشد که داشته باشیم
$\mathcal{A} = \s{\alpha_i\cdot\pi_i | i \in I}$.
در عبارت قبل
$I$
مدل زبانی
$NetKAT^{-dup}$
می‌باشد.
بر اساس لم ۵ در
\cite{dynetkat}
به ازای هر عبارت
$p$
در
$NetKAT^{-dup}$
یک عبارت
$p'$
به فرم نرمال وجود دارد که داشته باشیم:
$p\equiv p'$.
\begin{definition}
    \label{def:dynetkat-normal}
    زبان نت‌کت پویا‌ نرمال را با دستور زبان زیر تعریف می‌کنیم:
    \begin{align*}
        F ::= & \alpha\cdot\pi                                          \\
        D ::= & \bot | F;D | x?F;D | x!F;D | D \parallel D | D \oplus D
    \end{align*}
\end{definition}
با استفاده از این لم، در لم ۹ که در
\cite{dynetkat}
ثابت شده است،
به ازای هر عبارت 
$p$
در نت‌کت پویا یک عبارت معادل آن به فرم نرمال وجود دارد که داشته باشیم:
$p \equiv q$.
بنابراین در نهایت می‌توانیم هر عبارت نت‌کت پویا را به فرم یک عبارت نرمال 
با توجه به تعریف 
\ref{def:dynetkat-normal}
بنویسیم.
در ادامه فرض کنیم که
$\mc{A}$
مجموعه‌ی الفبا شامل تمامی حروف به شکل
$\alpha\cdot\pi,x?F,x!F$
باشد و داشته باشیم
$\alpha \in \mc{A}, L \subseteq \mc{A}$.
معنای عبارات نت‌کت پویای نرمال را با به صورت زیر تعریف می‌کنیم:
\begin{align*}
    \sem{\bot}              & = (\e,\e)                               \\
    \sem{\alpha;t}          & = \alpha(\sem{t})                       \\
    \sem{t_1 \oplus t_2}    & = \sem{t_1} + \sem{t_2}                 \\
    \sem{t_1 \parallel t_2} & = \sem{t_1} \times \sem{t_2}            \\
    \sem{\delta_{L}(t)}     & = \sem{t}\lceil \mathcal{A} \setminus L
\end{align*}
سمت چپ معادلات بالا عبارات نت‌کت پویای نرمال و در سمت راست ساختمان رویداد معادل هر یک مشخص شده است.
در معادلات بالا 
$(\e,\e)$
یک ساختمان رویداد که مجموعه‌ی رویداد‌ها و مجموعه‌ی برچسب‌های آن تهی است را نشان می‌دهد.